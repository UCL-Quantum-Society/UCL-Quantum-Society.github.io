---
export const prerender = true;
---

<div class="relative min-h-screen flex items-center">
  <div aria-hidden="true" class="absolute inset-0 grid grid-cols-2 -space-x-52 opacity-40"></div>
  <div class="relative w-full">
    <div class="lg:w-2/3 text-center mx-auto">
      <h1 id="hero-target" class="text-balance font-medium text-5xl md:text-6xl xl:text-7xl">
        <div id="hero-text" class="flex flex-col items-center gap-2"></div>
      </h1>
      <div class="m-12 flex flex-wrap justify-center gap-y-4 gap-x-6 fade-on-ready" aria-hidden="true">
        <a
          href="https://studentsunionucl.org/clubs-societies/quantum-society"
          target="_blank"
          rel="noopener noreferrer"
          class="relative flex h-11 w-full items-center justify-center px-6 rounded-full border border-primary/30 bg-[var(--color-primary)] hover:bg-[color-mix(in srgb, var(--color-primary) 80%, white)] text-white transition-all duration-300 transform hover:scale-105 sm:w-max"
        >
          <span class="relative text-base font-medium">Become a Member</span>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Spacer to separate hero from footer -->
<div class="hero-spacer" aria-hidden="true"></div>

<style is:global>
  .hero-spacer {
    height: 1rem;
  }
  @media (min-width: 768px) {
    .hero-spacer {
      height: 2rem;
    }
  }
  @media (min-width: 1280px) {
    .hero-spacer {
      height: 3rem;
    }
  }

  @keyframes wordFadeColor {
    0% {
      opacity: 0;
      color: var(--color-blue-200);
    }
    50% {
      opacity: 1;
      color: var(--color-blue-700);
    }
    100% {
      opacity: 1;
      color: var(--color-white);
    }
  }

  .word-animate {
    display: inline-block;
    animation: wordFadeColor 0.6s ease-out forwards;
    color: var(--color-white);
  }
</style>

<script>
  (() => {
    const heroText = document.getElementById('hero-text');
    const restFadeEls = Array.from(document.querySelectorAll('.fade-on-ready'));

    if (!heroText) return;

    // Define words with their respective styles
    const words = [
      { text: 'The', style: 'light', lineBreak: false },
      { text: 'future', style: 'light', lineBreak: false },
      { text: 'is', style: 'light', lineBreak: true },
      { text: 'Quantum', style: 'bold', lineBreak: false },
    ];

    const wordDelay = 200;
    let wordIndex = 0;
    let currentLine = null;

    function revealRest() {
      restFadeEls.forEach((el, idx) => {
        setTimeout(
          () => {
            el.classList.add('show');
            el.removeAttribute('aria-hidden');
            if (idx === 0) {
              const firstFocusable = el.querySelector('a, button, input, [tabindex]:not([tabindex="-1"])');
              if (firstFocusable instanceof HTMLElement) {
                setTimeout(() => firstFocusable.focus(), 420 + idx * 120);
              }
            }
          },
          600 * idx + 40
        );
      });
    }

    // Respect user's reduced motion preference
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReduced) {
      const line1 = document.createElement('div');
      line1.style.cssText =
        "font-family: 'SF Pro Display', 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif; font-weight: 500; letter-spacing: 0.5em; color: var(--color-primary);";
      line1.textContent = 'The future is';

      const line2 = document.createElement('div');
      line2.className = 'font-semibold text-white letter-spacing-0.5em';
      line2.textContent = 'Quantum';

      heroText.appendChild(line1);
      heroText.appendChild(line2);

      restFadeEls.forEach((el) => {
        el.classList.add('show');
        el.removeAttribute('aria-hidden');
      });
      return;
    }

    function createLine(style) {
      const line = document.createElement('div');
      if (style === 'light') {
        line.style.cssText =
          "font-family: 'SF Pro Display', 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif; font-weight: 300; letter-spacing: -0.02em;";
      } else {
        line.className += ' font-semibold';
      }
      return line;
    }

    function typeNextWord() {
      if (wordIndex < words.length) {
        const word = words[wordIndex];

        // Create new line if needed
        if (!currentLine || (wordIndex > 0 && words[wordIndex - 1].lineBreak)) {
          currentLine = createLine(word.style);
          heroText.appendChild(currentLine);
        }

        // Add word to current line with animation
        if (currentLine.childNodes.length > 0) {
          currentLine.appendChild(document.createTextNode(' '));
        }
        const wordSpan = document.createElement('span');
        wordSpan.className = 'word-animate';
        wordSpan.textContent = word.text;
        currentLine.appendChild(wordSpan);
        wordIndex++;
        setTimeout(typeNextWord, wordDelay);
      } else {
        revealRest();
      }
    }

    function startTyping() {
      setTimeout(typeNextWord, 300);
    }

    requestAnimationFrame(startTyping);
  })();
</script>
